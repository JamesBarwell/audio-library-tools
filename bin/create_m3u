#!/bin/bash

set -e

SAVEIFS=$IFS
IFS=$(echo -en "\n\b")

dir=$(readlink -f $1)
filetype=${2:-flac}
name=$(basename $dir)
m3u_path="$dir/$name.m3u8"

rm -f $m3u_path
echo "Creating m3u at: $m3u_path"

echo "#EXTM3U" >> $m3u_path

find $dir -type f -name "*.$filetype" -printf '%f\n' >> $m3u_path

#for filename in "$dir"/*.flac
#do
#    echo "${filename##*/}" >> $m3u_path
#done

IFS=$SAVEIFS
